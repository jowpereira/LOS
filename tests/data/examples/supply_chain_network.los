// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üè≠ SUPPLY CHAIN NETWORK DESIGN ‚Äî LOS v3 Complex Model
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//
// Problema: Planejamento integrado de produ√ß√£o e distribui√ß√£o para uma rede
// de supply chain com 4 plantas, 6 produtos e 8 clientes.
//
// Decis√µes:
//   - Quanto cada planta deve produzir de cada produto
//   - Quanto enviar de cada planta para cada cliente de cada produto
//   - Se hora extra √© necess√°ria em cada planta
//
// Objetivo: Minimizar custo total (produ√ß√£o + transporte + hora extra)
//
// Restri√ß√µes:
//   - Atendimento de demanda
//   - Capacidade de produ√ß√£o por planta
//   - Capacidade de rota de transporte
//   - Balan√ßo de fluxo (produ√ß√£o >= envio)
//   - Contrato m√≠nimo por cliente
//   - SLA de tempo de entrega
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# --- Data Imports ---
import "plantas.csv"
import "produtos_scm.csv"
import "clientes_scm.csv"
import "demanda.csv"
import "custo_transporte.csv"
import "capacidade_fabrica.csv"
import "cap_rota.csv"

# --- Sets ---
set Plantas = {P1, P2, P3, P4}
set Produtos = {ALPHA, BETA, GAMMA, DELTA, EPSILON, ZETA}
set Clientes = {C01, C02, C03, C04, C05, C06, C07, C08}
set Prioridade_A = {C01, C03, C06}

# --- Parameters ---
param custo_fixo[Plantas] = 0
param cap_max[Plantas] = 0
param custo_hora_extra[Plantas] = 0
param custo_fabrica[Plantas, Produtos] = 0
param custo_transporte[Plantas, Clientes] = 0
param demanda[Clientes, Produtos] = 0
param peso_produto[Produtos] = 0
param tempo_fabrica[Produtos] = 0
param cap_rota[Plantas, Clientes] = 0

# --- Decision Variables ---

// Produ√ß√£o: quantidade de cada produto em cada planta
var fabrica[Plantas, Produtos] >= 0

// Envio: fluxo de cada produto de cada planta para cada cliente
var envio[Plantas, Clientes, Produtos] >= 0

// Hora extra: horas adicionais em cada planta
var hora_extra[Plantas] >= 0

// Ativa√ß√£o de hora extra (bin√°ria)
var usa_extra[Plantas] : bin

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# OBJETIVO: Minimizar custo total
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

min: sum(custo_fabrica[p, j] * fabrica[p, j] for p in Plantas, j in Produtos) + sum(custo_transporte[p, c] * peso_produto[j] * envio[p, c, j] for p in Plantas, c in Clientes, j in Produtos) + sum(custo_hora_extra[p] * hora_extra[p] for p in Plantas)

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# RESTRI√á√ïES
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

st:
    // R1: Atendimento de demanda ‚Äî cada cliente recebe o que pediu
    atendimento[c, j]: sum(envio[p, c, j] for p in Plantas) >= demanda[c, j] for c in Clientes, j in Produtos

    // R2: Capacidade total de produ√ß√£o por planta
    capacidade[p]: sum(fabrica[p, j] for j in Produtos) <= cap_max[p] for p in Plantas

    // R3: Balan√ßo de fluxo ‚Äî n√£o enviar mais do que produziu
    balanco[p, j]: sum(envio[p, c, j] for c in Clientes) <= fabrica[p, j] for p in Plantas, j in Produtos

    // R4: Limite de rota de transporte (peso total por rota)
    rota[p, c]: sum(peso_produto[j] * envio[p, c, j] for j in Produtos) <= cap_rota[p, c] for p in Plantas, c in Clientes

    // R5: Horas de produ√ß√£o n√£o excedem horas normais + extras
    horas[p]: sum(tempo_fabrica[j] * fabrica[p, j] for j in Produtos) <= 2000 + hora_extra[p] for p in Plantas

    // R6: Hora extra limitada a 500h e vinculada √† vari√°vel bin√°ria
    extra_limite[p]: hora_extra[p] <= 500 * usa_extra[p] for p in Plantas
